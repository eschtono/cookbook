\chapter{IPA meets Unicode}
\label{ipa-meets-unicode}

% ==========================
\section{The International Phonetic Alphabet (IPA)}
\label{the-international-phonetic-alphabet}
% ==========================

The International Phonetic Alphabet (IPA) is a common standard in linguistics to
transcribe sounds of spoken language into Latin-based characters. Although IPA
is reasonably easily adhered to with pen and paper, it is not trivial to encode
IPA characters electronically. Similar to the previous chapter, this chapter
will discuss various pitfalls with the Unicode encoding of the IPA.\@ We will
specifically refer to the 2005 version of the IPA \citep{IPA2005} and the 7.0 
version of Unicode \citep{Unicode2014}.

The details of the encoding are unimportant as long as the
transcription is only directed towards phonetically trained eyes. For a linguist
reading an IPA transcription, many of the details that will be discussed in this
chapter might seem like hair-splitting trivialities. However, if IPA
transcriptions are intended to be used across resources (e.g.~searching similar
phenomena across different languages) then it becomes crucial that there are strict
encoding guidelines. Our main goal in this chapter is to present the encoding
issues and propose recommendations for a ``strict'' IPA encoding.

\ 

\noindent For a long time, linguists, like all other computer users, were
limited to ASCII-encoded 7-bit characters, which only includes Latin characters,
numbers and some punctuation and symbols. Restricted to these standard character
sets that lacked IPA support or other language-specific graphemes that they
needed, linguists devised their own solutions.\footnote{Early work addressing
the need for a universal computing environment for writing systems and their
computational complexity is discussed in \citet{Simons1989}. A survey of
practical recommendations for language resources, including notes on encoding,
can be found in \citet{BirdSimons2003}} For example, some chose to represent
unavailable graphemes with substitutes, e.g.~the combination of <ng> to
represent <ŋ>. Tech-savvy linguists redefined selected characters from a
character encoding by mapping custom made fonts to those code points. However,
one linguist's electronic text would not render properly on another linguist's
computer without access to the same font. Further, if two character encodings
defined two character sets differently, then data could not be reliably and
correctly displayed. This is a common example of the non-interoperability of
data and data formats.

To alleviate this problem, during the late 1980s, SAMPA (Speech Assessment
Methods Phonetic Alphabet) was created to represent IPA symbols with ASCII
character sequences, e.g. <p\textbackslash> for [ɸ]. Two problems with SAMPA are
that (i) it is only a partial encoding of the IPA and (ii) it encodes different
languages in separate data tables, instead of using a universal alphabet, like
IPA.\@ SAMPA tables are derived from phonemes appearing in several European
languages that were developed as part of a European Commission-funded project to
address technical problems like electronic mail exchange (what is now simply
called email). SAMPA is essentially a hack to work around displaying IPA
characters, but it provided speech technology and other fields a basis that has
been widely adopted and used in code. So, SAMPA was a collection of tables to be
compared, instead of a large universal table representing all languages. An
extended version of SAMPA, called X-SAMPA, set out to include every symbol in
the IPA chart including all diacritics \citep{WellsND}. X-SAMPA was considered
more universally applicable because it consisted of one table that encoded all
characters that represented phones/segments in IPA across languages. SAMPA and
X-SAMPA have been widely used for speech technology and as an encoding system in
computational linguistics. Eventually, ASCII-encoding of the IPA became
deprecated through the advent of the Unicode Standard. Note however that many
popular software packages used for linguistic analyses still require ASCII
input, e.g.~RuG/L04 and SplitsTree4.\footnote{See
\url{http://www.let.rug.nl/kleiweg/L04/} and \url{http://www.splitstree.org/},
respectively}

There are a few pitfalls to be aware of when using the Unicode Standard to
encode IPA.\@ As we have said before, from a linguistic perspective it might
sometimes look like the Unicode Consortium is making incomprehensible decisions,
but it is important to realize that the consortium has tried and is continuing
to try to be as consistent as possible across a wide range of use cases, and it
does place linguistic traditions above other orthographic possibilities. In
general, we strongly suggest linguists not to complain about any decisions in
the Unicode Standard, but to try and understand the rationale of the Unicode
Consortium (which in our experience is almost always well-conceived) and devise
ways to work with any unexpected behavior. Many of the current problems derive
from the fact that the IPA is clearly historically based on the Latin script,
but different enough from most other Latin-based writing systems to warrant
special attention. This ambivalent status of the IPA glyphs (partly Latin,
partly special) is unfortunately also attested in the treatment of IPA in the
Unicode Standard. In retrospect, it might have been better to consider the IPA
(and other transcription systems) to be a special kind of script within
the Unicode Standard, and treat the obvious similarity to Latin glyphs as a
historical relic. All IPA glyphs would then have their own code points, instead
of the current situation in which some IPA glyphs have special code points,
while others are treated as being identical to the regular Latin characters.
Yet, the current situation, however unfortunate, is unlikely to change, so as
linguists we will have to learn to deal with the specific pitfalls of IPA within
the Unicode Standard. In this section, we will describe these pitfalls in some
detail.

% ==========================
\section{Pitfall: No complete IPA code block}
\label{pitfall-no-complete-ipa-block}
% ==========================

The ambivalent nature of IPA glyphs arises because, on the one hand, the IPA
uses Latin-based glyphs like <a>, <b> or <p>. From this perspective, the IPA
seems to be just another orthographic tradition using Latin characters, all of
which do not get a special treatment within the Unicode Standard (just like
e.g.~the French, German, or Danish orthographic traditions do not have a special
status). On the other hand, the IPA uses many special symbols (like turned <ɐ>,
mirrored <ɘ> and/or extended <ɧ> Latin glyphs) not found in any other Latin-based
writing system. For this reason a special block with code points, called
\textsc{IPA Extensions} was included already in the first version of the Unicode
Standard (Version 1.0 from 1991).

As explained in Section~\ref{pitfall-blocks}, the Unicode Standard code space is
subdivided into character blocks, which generally encode characters from a
single script. However, as is illustrated by the IPA, characters that form a
single writing system may be dispersed across several different character
blocks. With its diverse collection of symbols from various scripts and
diacritics, the IPA is spread across 13 blocks in the Unicode
Standard:\footnote{This number of blocks depends on whether only IPA-sanctioned
symbols are counted or if the phonetic symbols commonly found in the literature
are also included, see~\cite[Appendix~C]{Moran2012}. The 159 characters from 13 
code blocks shown here are the characters proposed for ``strict'' IPA encoding, 
as discussed in Section~\ref{ipa-recommendations}.}

\begin{itemize}[itemsep=4pt]
	\item \textsc{Basic Latin }(27 characters) \newline 
	a b c d e f h i j k l m n o p q r s t u v w x y z~.~|
	\item \textsc{Latin-1 Supplement} (4 characters) \newline 
	æ ç ð ø
	\item \textsc{Latin Extended-A} (3 characters) \newline 
	ħ ŋ œ
	\item \textsc{Latin Extended-B} (4 characters) \newline 
	ǀ ǁ ǂ ǃ
	\item \textsc{IPA Extensions} (67 characters) \newline 
	ɐ ɑ ɒ ɓ ɔ ɕ ɖ ɗ ɘ ə ɛ ɜ ɞ ɟ ɠ ɡ ɢ ɣ ɤ ɥ ɦ ɧ ɨ ɪ ɬ ɭ ɮ ɯ ɰ ɱ ɲ ɳ ɴ \newline
	ɵ ɶ ɸ ɹ ɺ ɻ ɽ ɾ ʀ ʁ ʂ ʃ ʄ ʈ ʉ ʊ ʋ ʌ ʍ ʎ ʏ ʐ ʑ ʒ ʔ ʕ ʘ ʙ ʛ ʜ ʝ ʟ ʡ ʢ 
	\item \textsc{Spacing Modifier Letters} (17 characters) \newline
	\dia{02DE} \dia{02E1} \dia{02B7} \dia{02B2} \dia{02E0} \dia{02E4} 
	\dia{02B0} \dia{02BC} \dia{02D0} \dia{02D1} ˥ ˦ ˧ ˨ ˩ {\large ˈ ˌ}
	\item \textsc{Combining Diacritical Marks} (25 characters) \newline 
	\dia{033C} \dia{032A} \dia{033B} \dia{033A} \dia{031F} \dia{0320} \dia{031D} 
	\dia{031E} \dia{0318} \dia{0319} \dia{031C} \dia{0339} \dia{032C} \dia{0325} 
	\dia{0330} \dia{0324} \dia{0329} \dia{032F} \dia{0334} \dia{0303} \dia{0308} 
	\dia{033D} \dia{0306} \dia{031A} \ \dia{0361}◌
	\item \textsc{Greek and Coptic} (3 characters) \newline 
	β θ χ
    \item \textsc{General Punctuation} (2 characters) \newline 
    ‖ \charis{‿}
	\item \textsc{Superscripts and Subscripts} (1 character) \newline
	\dia{207F} 
	\item \textsc{Modifier Tone Letters} (2 characters) \newline
	ꜛ ꜜ
	\item \textsc{Arrows} (2 characters) \newline 
	↗ ↘
	\item \textsc{Latin Extended-C} (1 character): \newline
	\charis{ⱱ}
\end{itemize}

% ==========================
\section{Pitfall: IPA homoglyphs in Unicode}
\label{pitfall-ipa-homoglyphs}
% ==========================

Another problem is the large number of homoglyphs, i.e.~different characters
that have highly similar glyphs (or even completely identical glyphs, depending
on the font rendering). For example, a user of a Cyrillic computer keyboard
should ideally not use the <а> \textsc{cyrillic small letter a} at code point
\uni{0430} for IPA transcriptions, but instead use the <a> \textsc{latin small
letter a} at code point \uni{0061}, although visually they are mostly
indistinguishable, and the Cyrillic character is more easily typed on a Cyrillic
keyboard. Some further problematic homoglyphs related to encoding IPA in the
Unicode Standard are the following.

\begin{itemize}

  \item The uses of the apostrophe has led to long discussions on the Unicode
        Standard email list. An English keyboard inputs the symbol
        <\dia{0027}> \textsc{apostrophe} at \uni{0027}, although the preferred Unicode
        apostrophe is the <\dia{2019}> \textsc{right single quotation mark} at
        \uni{2019}.\footnote{Note that many word processors (like Microsoft
        Word) by default will replace straight quotes by curly quotes,
        depending on the whitespace around it.} However, the glottal
        stop/glottalization/ejective marker is yet another completely different
        character, namely <\dia{02BC}>, i.e.~the \textsc{modifier letter apostrophe} 
        at \uni{02BC}, which unfortunately looks mostly extremely similar to
        \uni{2019}. 
  \item Another problem is the <\dia{02C1}> \textsc{modifier letter reversed glottal
        stop} at \uni{02C1} vs.\@ the <\dia{02E4}> \textsc{modifier letter small reversed
        glottal stop} at \uni{02E4}. Both appear in various resources
        representing phonetic data online. This is thus a clear example for
        which the Unicode Standard does not solve the linguistic standardization
        problem.
  \item Linguists are also unlikely to distinguish between the <ə>
        \textsc{latin small letter schwa} at code point \uni{0259} and <ǝ>
        \textsc{latin small letter turned e} at \uni{01DD}.
  \item The alveolar click <ǃ> at \uni{01C3} is of course often simply
        typed as <!> \textsc{exclamation mark} at \uni{0021}.\footnote{In the
        Unicode Standard the <ǃ> at \unif{01C3} is labeled \textsc{latin letter
        retroflex click}, but in IPA that glyph is used for an alveolar or
        postalveolar click (not retroflex). This naming is probably best seen as
        an error in the Unicode Standard. For the ``real'' retroflex click, see 
        Section~\ref{ipa-additions}.}
  \item The dental click <ǀ>, in Unicode known as \textsc{latin letter dental
        click} at \uni{01C0}, is often simply typed as <|> \textsc{vertical
        line} at \uni{007C}.
  \item For the marking of length there is a special Unicode characters, namely
        <\dia{02D0}> \textsc{modifier letter triangular colon} at \uni{02D0}. However,
        typing <\dia{003A}> \textsc{colon} at \uni{003A} is of course much easier.        
  
\end{itemize} 


Conversely, non-linguists are unlikely to distinguish any semantic difference
between an open back unrounded vowel <ɑ> \textsc{latin small letter alpha} at
\uni{0251}, and the open front unrounded vowel <a> \textsc{latin small letter a}
at \uni{0061}, basically treating them as homoglyphs, although they are
different phonetic symbols. But even among linguists this distinction leads to
problems. For example, as pointed out by \citet{Mielke2009}, there is a problem
stemming from the fact that about 75\% of languages are reported to have a
five-vowel system \citep{Maddieson1984}. Historically, linguistic descriptions
tend not to include precise audio recording and measurements of formants, so
this may lead one to ask if the many <a> characters that are used in
phonological description reflects a transcriptional bias. The common use of <a>
in transcriptions could be in part due to the ease of typing the letter on an
English keyboard (or for older descriptions, the typewriter). We found it to be
exceedingly rare that a linguist uses <ɑ> for a low back unrounded
vowel.\footnote{One example is \citet[75]{Vidal2001a}, in which the author
states: ``The definition of Pilagá /a/ as [+back] results from its behavior in
certain phonological contexts. For instance, uvular and pharyngeal consonants
only occur around /a/ and /o/. Hence, the characterization of /a/ and /o/ as a
natural class of (i.e., [+back] vowels), as opposed to /i/ and /e/.''} They
simply use <a> as long as there is no opposition to <ɑ>.

%\footnote{See Thomason's Language Log post, ``Why I don't love the International Phonetic Alphabet'' at:\url{http://itre.cis.upenn.edu/~myl/languagelog/archives/005287.html}.}

Making things even more problematic, there is an old typographic tradition that
the double-story <a> uses a single-story <ɑ> in italics. This leads to the
unfortunate effect that even in many well-designed fonts the italics of <a> and
<ɑ> use the same glyph. For example, in Linux Libertine (the font of this book)
the italics of these characters are highly similar <\textit{a}> and
<\textit{ɑ}>, while in Charis SIL they are identical: <\textit{\charis{a}}> and
<\textit{\charis{ɑ}}>. If this distinction has to be kept upright in italics,
the only solution we can currently offer is to use \textsc{slanted} glyphs
(i.e.~artificially italicized glyphs) instead of real italics (i.e.~special
italics glyphs designed by a typographer).\footnote{For example, the widely used
IPA font Doulos SIL
(\url{http://scripts.sil.org/cms/scripts/page.php?item\_id=DoulosSIL}) does not
have real italics. This leads some word-processing software, like Microsoft
Word, to produce slanted glyphs instead. That particular combination of font and
software application will thus lead to the desired effect distinguishing <a>
from <ɑ> in italics. However, note that when the text is transferred to another
font (i.e.~one that includes real italics) and/or to another software
application (like Apple Pages, which does not perform slanting), then this
visual appearance will be lost. In this case we are thus still in the
pre-Unicode situation in which the choice of font and rendering software
actually matters. The ideal solution from a linguistic point of view would be
the introduction of a new IPA code point for a different kind of <a>, which
explicitly specifies that it should still be rendered as a double-story
character when italicized. After informal discussion with various Unicode
players, our impression is that this highly restricted problem is not
sufficiently urgent to introduce even more <a> homographs in Unicode (which
already lead to much confusion, see Section~\ref{pitfall-homoglyphs}).}

% ==========================
\section{Pitfall: Homoglyphs in IPA}
\label{pitfall-homoglyphs-in-IPA}
% ==========================

Reversely, there are a few cases in which the IPA distinguishes different
phonetic concepts, but the visual characters used by the IPA look very much
alike. Such cases are thus homoglyphs in the IPA itself, which of course need
different encodings.

\begin{itemize}
  
   \item The dental click <ǀ> and the indication of a minor group break <|>
           look almost the same in
           most fonts. For a proper encoding, the \textsc{latin letter dental
           click} at \uni{01C0} and the \textsc{vertical line }at \uni{007C} 
           should be used, respectively.
   \item Similarly, the alveolar lateral click <ǁ>	should be encoded with a
           \textsc{latin letter lateral click} at \uni{01C1}, different from <‖>, 
           which according to the IPA is the character to by used for a major group 
           break (by intonation), to be encoded by \textsc{double vertical line} 
           at \uni{2016}.
   \item The marking of primary stress < ˈ > looks like an apostrophe, and
           is often typed with the same symbol as the ejective <\dia{02BC}>. For a
           proper encoding, these two symbols should be typed as 
           \textsc{modifier letter vertical line} at \uni{02C8} and
           \textsc{modifier letter apostrophe} at \uni{02BC}, respectively. 
   \item There are two different ``dashed''-l characters in IPA, namely the <ɫ> 	      \textsc{latin small letter l with middle tilde} at \uni{026B} and the <ɬ>	      \textsc{latin small letter l with belt} at \uni{026C}. These of course
          look highly similar, although they are different sounds. As a solution, 
          we will actually propose to not use the middle tilde at all 
          (see Section~\ref{pitfall-multiple-options-ipa}).     
   
\end{itemize}

% ==========================
\section{Pitfall: Multiple encoding options in IPA}
\label{pitfall-multiple-options-ipa}     
% ========================== 

It is not just the Unicode Standard that offers multiple options for encoding
the IPA.\@ Even the IPA specification itself offers some flexibility in how
transcriptions have to be encoded. There are a few cases in which the IPA
explicitly allows for different options of transcribing the same phonetic
content. This is understandable from a transcriber's point of view, but it is
not acceptable when the goal is interoperability between resources written in
IPA.\@ We consider it crucial to distinguish between ``lax'' IPA, for which it
is sufficient that any phonetically-trained reader is able to understand the
transcription, and ``strict'' IPA, which should be standardized on a single
unique encoding for each sound, so search will work across resources. We are
aware of the following non-unique encoding options in the IPA, which will be
discussed in turn below:

\begin{itemize}
  \item The marking of tone
  \item The marking of <g>
  \item The marking of velarization and pharyngealization
  \item The placement of diacritics
\end{itemize}

The first case in which the IPA allows for different encodings is the question
of how to transcribe tone. There is an old tradition to use diacritics on vowels
to mark different tone levels, e.g. <ȅèée̋>.\footnote{To make things even more
complexe, there are at least two different Unicode homoglyphs for the low and
high level tones, namely <\diaf{0340}> \textsc{combining grave tone mark} at
\unif{0340} vs.~<\diaf{0300}> \textsc{combining grave accent} at \unif{0300} for
low tone, and <\diaf{0341}> \textsc{combining acute tone mark} at \unif{0341}
vs.<\diaf{0301}> \textsc{combining acute accent} at \unif{0301} for high tone.}
The IPA also proposes the option of tone letters, e.g. <˥˦˧˨˩>, which are much
less often used, but are more consistent for contours. Tone letters in the IPA
have five different levels, and sequences of these letters can be used to
indicate contours. Well-designed fonts will even merge a sequence of tone
letters into a contour. For example, compare the font Linux Libertine, which
does not merge tone letters <{\fontspec{LinLibertineO}˥˨˧˩}>, with the font
CharisSIL, which merges this sequence of four tone letters into a single contour
<\charis{˥˨˧˩}>. For strict IPA encoding we propose to standardize on tone
letters.

Second, we commonly encounter the use of <g> \textsc{latin small letter g} at
\uni{0067}, instead of the Unicode Standard IPA character for the voiced velar
stop <ɡ> \textsc{latin small letter script g} at \uni{0261}. One begins to
question whether this issue is at all apparent to the working linguist, or if
they simply use the \uni{0067} because it is easily keyboarded and thus saves
time, whereas the latter must be cumbersomely inserted as a special symbol in
most software. The International Phonetic Association has taken the stance that
both the keyboard \textsc{latin small letter g} and the \textsc{latin small
letter script g} are valid input characters for the voiced velar plosive.
Unfortunately, this decision further introduces ambiguity for linguists trying
to adhere to a strict Unicode Standard IPA encoding. For strict IPA encoding we
propose to standardize on the more idiosyncratic \textsc{latin small letter
script g} at \uni{0261}.

Third, the IPA has special markers for velarization <\dia{02E0}> and
pharyngealization <\dia{02E4}>. Confusingly, there is also a marker for
``velarized or pharyngealized'', using the <\dia{0334}> \textsc{combining tilde
overlay} at \uni{0334}. The tilde overlay seems to be extremely rarely used. We 
suggest to try and avoid using the tilde overlay, though for reasons of backward 
compatibility we will allow it in strict-IPA.\@

Finally, the IPA states that ``diacritics may be placed above a symbol with a
descender''. For example, for marking marking of voiceless pronunciation of
voiced segments the IPA uses the ring diacritic. Originally, the ring should be
placed below the base character, like in <m̥>, using the \textsc{combining ring
below} at \uni{0325}. However, in letters with long descenders the IPA also
allows to put the ring above the base, like in <ŋ̊>, using the \textsc{combining
ring above} at \uni{030A}. Yet, proper font design does not have any problem
with rendering the ring below the base character, like in <ŋ̥>, so for strict
IPA encoding we propose to standardize on the ring below. As a principle, for
strict IPA encoding only one options should be allowed for all diacritics.

The variable encoding as allowed by the IPA becomes even more troublesome for
the tilde and diaeresis diacritics. In these cases, the IPA itself attaches
different semantics to the symbols above and below a base characters. The tilde
above a character (like in <ã>, using the \textsc{combining tilde} at
\uni{0303}) is used for nasalisation, while the tilde below a character (like in
<a̰>, using the \textsc{combining tilde below} at \uni{0330}) indicates creaky
voice. Likewise, the diaeresis above (like in <ä>, using the \textsc{combining
diaeresis} at \uni{0308}) is used for centralization, while the diaeresis below
a character (like in <a̤>, using the \textsc{combining diaeresis below} at
\uni{0324}) indicates breathy voice. These cases strengthen our plea to not
allow diacritics to switch position for typographic convenience.

% ==========================
\section{Pitfall: Tie bar}
\label{pitfall-tie-bar}
% ==========================

The IPA includes a tie bar. The tie-bar is a convenient diacritic for visually
tokenizing input strings into chunks of phonetically salient groups, for example
to indicate affricates, doubly articulated consonants or diphthongs. This
character can be placed above or below the base characters, e.g. <\charis{t͡s}>
or <\charis{t͜s}>. IPA allows both options. The choice between the two symbols
is purely for legible rendering; there is no difference in semantics between the
two symbols. However, rendering is such a problematic issue for tie bars in
general that many linguists simply do not use them. Just looking at a few
different fonts already indicates that actually no font designer really gets the
placement right in combination with superscripts and subscripts. If really
necessary, we propose to standardize on the tie bar above the base characters,
using a \textsc{combining double inverted breve} at \uni{0361}.

\begin{itemize}[itemsep=6pt]
  \item[] {\fontspec{Times New Roman}Times new Roman: t̥ʰ͡s t̥ʰ͜s}
  \item[] {\small \fontspec{CharisSIL}CharisSIL:\@ t̥ʰ͡s t̥ʰ͜s}
  \item[] {\footnotesize \fontspec{Monaco}Monaco: t̥ʰ͡s t̥ʰ͜s}
  \item[] {\fontspec{DoulosSIL}DoulosSIL:\@ t̥ʰ͡s t̥ʰ͜s}
  \item[] Linux Libertine: t̥ʰ͡s t̥ʰ͜s
\end{itemize}

Tie bars are a special type of character in the sense that they do not belong to
a segment, but bind two graphemes together. This actually turns out to be rather
different from Unicode conceptions. The Unicode encoding of this character
belong to the Combining Diacritical Marks, namely either \textsc{combining double
inverted breve} at \uni{0361} or \textsc{combining double breve below} at
\uni{035C}. Such a combining mark is by definition tied to the character in
front, but not the character following it. The Unicode treatment of this
character thus only partly corresponds to the IPA conception, which ideally
would have the tie bar linked both to the character in front and to the
character following. 

Further, according to the spirit of the IPA, it would also be possible to
combine more than two base characters into one tie bar, but this is not possible
with Unicode (i.e.~there is no possibility to draw a tie bar over three of four
characters). It is possible to indicate such larger groups by repeating the tie
bar, like for a triphthong <a͡ʊ͡ə> in the English word \textit{hour}. If really
necessary, we consider this possible, even though the rendering will never look
good. 

Most importantly though, in comparison to normal Unicode processing, the tie-bar
actually takes a reversed approach to complex graphemes. Basically, the Unicode
principle (see Section~\ref{pitfall-characters-are-not-graphemes}) is that fixed
sequences in a writing system have to be specified as ``tailored'' grapheme
clusters. In case the sequence is not a cluster, this has to be explicitly
indicated. IPA takes a different approach. In IPA by default different base
letters are not connected into larger clusters; only when it is specified in the
string itself (using the tie bar).

% ==========================
\section{Pitfall: Ligatures and digraphs}
\label{pitfall-ligatures-digraphs}     
% ==========================   

One important distinction to acknowledge is the difference between multigraphs
and ligatures. Multigraphs are groups of characters (in the context of IPA e.g.
<tʃ> or <ou>) while ligatures are single characters (e.g. <ʧ> \textsc{latin
small letter tesh digraph} at \uni{02A7}). Ligatures arose in the context of
printing easier-to-read texts, and are included in the Unicode Standard for
reasons of legacy encoding. However, their usage is discouraged by the Unicode
core specification. Specifically related to IPA, various phonetic combinations
of characters (typically affricates) are available as single code-points in the
Unicode Standard, but are designated \textsc{digraphs}. Such glyphs might be used by
software to produce a pleasing display, but they should not be hard-coded into
the text itself. In the context of IPA, characters like the following ligatures
should thus \emph{not} be used. Instead a combination of two characters is
preferred:
      
\begin{itemize} 
	\item[] <ʣ> \textsc{latin small letter dz digraph} at \uni{02A3} 
	  (use <dz>) 
    \item[] <ʤ> \textsc{latin small letter dezh digraph} at \uni{02A4}
      (use <dʒ>)
    \item[] <ʥ> \textsc{latin small letter dz digraph with curl} at \uni{02A5}
      (use <dʑ>)
    \item[] <ʦ> \textsc{latin small letter ts digraph} at \uni{02A6} 
      (use <ts>)
	\item[] <ʧ> \textsc{latin small letter tesh digraph} at \uni{02A7} 
	  (use <tʃ>) 
    \item[] <ʨ> \textsc{latin small letter tc digraph with curl} at \uni{02A8}
      (use <tɕ>)
   	\item[] <ʩ> \textsc{latin small letter feng digraph} at \uni{02A9}
	  (use <fŋ>) 
\end{itemize}

However, there are a few Unicode characters that are historically ligatures, but
which are today considered as simple characters in the Unicode Standard and thus
should be used when writing IPA, namely:

\begin{itemize}
	\item[] <ɮ> \textsc{latin small letter lezh} at \uni{026E} 
	\item[] <œ> \textsc{latin small ligature oe} at \uni{0153} 
	\item[] <ɶ> \textsc{latin letter small capital oe} at \uni{0276} 
	\item[] <æ> \textsc{latin small letter ae} at \uni{00E6} 
\end{itemize}

% ==========================
\section{Pitfall: Missing decomposition}
\label{pitfall-missing-decomposition}
% ==========================

Although many combinations of base character with diacritic are treated as
canonical equivalent with precomposed characters, there are a few combinations
in IPA that allow for multiple, apparently identical, encodings that are not
canonical equivalent (see Section~\ref{pitfall-canonical-equivalence}). The
following elements should not be treated as diacritics when encoding IPA in
Unicode: 
\begin{itemize}
  \item[] <{\fontspec{CharisSIL}{\large ◌}}\symbol{"0321}> \textsc{combining palatalized hook below} at \uni{0321}
  \item[] <{\fontspec{CharisSIL}{\large ◌}}\symbol{"0322}> \textsc{combining retroflex hook below} at \uni{0322}
  \item[] <\dia{0335}> \textsc{combining short stroke overlay} at \uni{0335}
  \item[] <\dia{0337}> \textsc{combining short solidus overlay} at \uni{0337}
\end{itemize} 

There turn out to be a lot of characters in the IPA that could be conceived as
using any of these elements, like <ɲ>, <ɳ>, <ɨ> or <ø>. However, all such
characters exist as well as precomposed combination in Unicode, and these
precomposed characters should preferably be used.\footnote{The IPA does not
describe any character for a voiced retroflex implosive, which would
transparently be \charis{ᶑ}. We propose to add this character to the IPA, see
Section~\ref{ipa-additions}.} When instead combinations of a base character with
diacritic are used, then these combinations are not canonical equivalent to the
precomposed combinations. This means that any search will not find both at the
same time.

A similar problem arises with the rhotic hook. There are two precomposed
characters in Unicode with a rhotic hook, which are not canonical equivalent 
with a combination of the vowel with a separately encoded hook:
\begin{itemize}
  \item[] <ɚ> \textsc{latin small letter schwa with hook} at \uni{025A}
  \item[] <ɝ> \textsc{latin small letter reversed open e with hook} at \uni{025D}
\end{itemize}
All other combinations of vowels with rhotic hooks will have to be made by using
<\dia{02DE}> \textsc{modifier letter rhotic hook} at \uni{02DE}, because there
is not complete set of precomposed characters with rhotic hooks. For that reason
we propose to not use the two precomposed characters with hooks mentioned above,
but always use the separate rhotic hook at \uni{02DE} in IPA.\@

A similar situation arises with <\dia{0334}> \textsc{combining tilde overlay} at
\uni{0334}. The main reason some phoneticians like to use this in IPA is to mark
the ``dark'' <l> in English codas, using the character <ɫ> \textsc{latin small
letter l with middle tilde} at \uni{026B}. This character is not canonically
equivalent to the combination <l> + <\dia{0334}>, so one of the two possible
encodings has to be chosen. Because the tilde overlay is described as a general
mechanism by the IPA, we propose to use the separated <\dia{0334}>
\textsc{combining tilde overlay} at \uni{0334}. However, note that phonetically 
this seems to be (almost) superfluous (see Section~\ref{pitfall-multiple-options-ipa}) 
and the typical usage in the form of <ɫ> is (almost) a homoglyph with <ɬ> (see 
Section~\ref{pitfall-homoglyphs-in-IPA}). For these reasons we suggest to try 
and avoid the tilde overlay.

Reversely, note that the <ç> \textsc{latin small letter c with cedilla} at
\uni{00E7} is canonically equivalent with <c> with <\dia{0327}>
\textsc{combining cedilla} at \uni{0327}, so it will be separated into two
characters by Unicode canonical decomposition, also if such a decomposition is
not intended in the IPA.\@ However, because of the nature of canonical
equivalence (see Section~\ref{pitfall-canonical-equivalence}), these two
encodings are completely identical in any computational treatment, so this
decomposition does not have any practical consequences.

% ==========================
\section{Pitfall: Different notions of diacritics}
\label{pitfall-different-notions-of-diacritics}
% ==========================

Another pitfall relates to the question of what are diacritics. The problem is that
the meaning of the term diacritics as used by the IPA is not the same as is used
in the Unicode Standard. Specifically, diacritics in the IPA-sense are either
so-called \textsc{combining diacritical marks} or \textsc{spacing modifier
letters} in the Unicode Standard. Crucially, Combining Diacritical Marks are by
definition combined with the character before them (to form so-called default
grapheme clusters, see Section~\ref{the-unicode-approach}). In contrast, Spacing
Modifier Letters are by definition \emph{not} combined into grapheme clusters
with the preceding character, but simply treated as separate letters. In the
context of the IPA, the following IPA-diacritics are actually Spacing Modifier
Letters in the Unicode Standard:

\begin{itemize}
  
	\item[] Length marks, namely: 
	\begin{itemize}
	  \item[] <\dia{02D0}> \textsc{modifier letter triangular colon} at \uni{02D0}
	  \item[] <\dia{02D1}> \textsc{modifier letter half triangular colon} at \uni{02D1}
	\end{itemize}
	 
	\item[] Tone letters, like: 
	\begin{itemize} 
	  \item[] <˥> \textsc{modifier letter extra-high tone bar} at \uni{02E5}
	  \item[] <˨> \textsc{modifier letter low tone bar} at \uni{02E8}
	  \item[] and others like this
	\end{itemize}
	
	\item[] Superscript letters, like:
	\begin{itemize}
	  \item[] <\dia{02B0}> \textsc{modifier letter small h} at \uni{02B0}
	  \item[] <\dia{02E4}> \textsc{modifier letter small reversed glottal stop} at \uni{02E4}
	  \item[] <\dia{207F}> \textsc{superscript latin small letter n} at \uni{207F}
	  \item[] and many more like this
	\end{itemize}
	
	\item[] The rhotic hook:\footnote{It is really unfortunate that the rhotic hook
         in Unicode is classified as a Spacing Modifier, and not as a Combining 
         Diacritical Mark. Although the rhotic hook is placed to the right of its 
         base character (and not above or below), it still is always connected 
         to the character in front, even physically connected to it. We cannot 
         find any reason for this treatment, and consider it an error in 
         Unicode. We hope it will be possible to change this classification in 
         the future.}
	\begin{itemize}
	  \item[] <\dia{02DE}> \textsc{modifier letter rhotic hook} at \uni{02DE}
	\end{itemize}
	
\end{itemize}

Although linguists might expect these characters to belong together with the
character in front of them, at least for <ʰ> \textsc{modifier letter small h} at
\uni{02B0} the Unicode Consortium's decision to treat it as a separate character
is also linguistically correct, because according to the IPA it can be used both
for aspiration (more precisely post-aspiration following the base character) and
pre-aspiration (preceding the base character). The default combination of Spacing Modifiers with
the preceding character can be specified in orthography profiles (see
Chapter~\ref{orthography-profiles}).

% ==========================
\section{Pitfall: No unique diacritic ordering}
\label{pitfall-no-unique-diacritic-ordering}
% ==========================

Also related to diacritics is the question of ordering. To our knowledge, the
International Phonetic Association does not specify a specific ordering for
diacritics that combine with phonetic base symbols; this exercise is left to the
reasoning of the transcriber. However, such marks have to be explicitly ordered
if sequences of them are to be interoperable and compatible computationally. An example is a
labialized aspirated alveolar plosive: <tʷʰ>. There is nothing holding linguists
back from using <tʰʷ> instead (with exactly the same intended meaning). However,
from a technical standpoint, these two sequences are different, e.g.~if both
sequences are used in a document, searching for <tʷʰ> will not find any
instances of <tʰʷ>, and vice versa. Likewise, a creaky voiced syllabic dental
nasal can be encoded in various orders, e.g. <n̪̰̩>, <n̩̰̪> or <n̩̪̰>.

\subsubsection*{Canonical combining classes}

In accordance with the absence of any specification of ordering in the IPA, the
Unicode Standard likewise does not propose any standardized orders. Both leave it
to the user to be consistent; this approach naturally invites inconsistency across 
different authored resources.

There is one aspect of ordering for which the Unicode Standard does present a
canonical solution. However, it is uncontroversial from a linguistic
perspective. Diacritics in the Unicode Standard (i.e.~Combining Diacritical
Marks, see above) are classified in Canonical Combining Classes. In practice,
the diacritics are distinguished by their position relative to the base
character.\footnote{See
\url{http://unicode.org/reports/tr44/#Canonical_Combining_Class_Values} for a
detailed description.} When applying a Unicode normalization (NFC or NFD, see
Section~\ref{pitfall-canonical-equivalence}), the diacritics in different
positions are put in a specified order. This process therefore harmonizes the
difference between different encodings, e.g.\ of an extra-short creaky voice
vowel <ḛ̆>. This grapheme cluster can be encoded either as
<e>+<\dia{0306}>+<\dia{0330}> or as <e>+<\dia{0330}>+<\dia{0306}>. To
prevent this twofold encoding, the Unicode Standard specifies the second
ordering as canonical (in this case, diacritics below are put before diacritics
above).

When encoding a string according to the Unicode Standard, it is possible to do
this either using the NFC (composition) or NFD (decomposition) normalization.
Decomposition implies that precomposed characters (like <á> \textsc{latin small
letter a with acute} at \uni{00E1}) will be split into its parts. This might
sound preferable for a linguistic analysis, as the different diacritics are
separated from the base characters. However, note that most attached elements
like strokes (e.g.~in the <ɨ>), retroflex hooks (e.g.~in <ʐ>) or rhotic hooks
(e.g.~in <ɝ>) will not be decomposed, but strangely enough a cedilla (like in
<ç>) will be decomposed (see Section~\ref{pitfall-missing-decomposition}). In
general, Unicode decomposition does not behave like a feature decomposition as
expected from a linguistic perspective. It is thus important to consider Unicode
decomposition only as a technical procedure, and not assume that it is
linguistically sensible.

\subsubsection*{Proposal for diacritic ordering}

Facing the problem of specifying a consistent ordering of diacritics while
developing a large database of phonological inventories from the world's
languages, \citet[540]{Moran2012} defined a set of diacritic ordering
conventions. The conventions are influenced by the linguistic literature, though
some ad-hoc decisions had to be taken given the vast variability of phonological
segments described by linguists. 

By Unicode Canonical Combining Classes, the diacritics on top of a character,
like <\dia{0334}> (Combining Class number 1), always come before diacritics
below (Combining Class number 220), which in turn always come before diacritics
above (Combining Class number 230), which in turn come before diacritics over
multiple characters like the tie bar <\dia{0361}{\large\fontspec{CharisSIL}◌}>
(Combining Class number 233). We follow this order, but add the other IPA
diacritics (which are not diacritics in the Unicode sense) between diacritics
below and the tie bar. Within all these classes of diacritics there is no canonical
ordering specified by Unicode, so we propose an explicit ordering here.

Starting with the diacritics below: if a character sequence contains more than
one diacritic below the base character, then the place features are applied
first (linguolabial, dental, apical, laminal, advanced, retracted), followed by
the manner features (raised, lowered, advanced and retracted tongue root), then
secondary articulations (more round, less round), laryngeal settings (creaky,
breathy, voiced, devoiced), and finally the syllabic or non-syllabic marker. So,
the order that is proposed is the following, where <\textbar{}> indicates
\textit{or} and <→> indicates \textit{precedes}. Note that the groups of
alternatives (as marked by <\textbar{}>) are supposed never to occur together
with the same base character. In effect, this represents yet another restriction
on possible diacritic sequences.

\begin{itemize}
	\item[] \textsc{Combining Diacritical Marks (below) ordering:}
	\begin{itemize}	
	  \item[→] linguolabial <\dia{033C}> \textbar{} dental <\dia{032A}> \textbar{} apical <\dia{033A}> \textbar{} laminal <\dia{033B}>
	  \item[→] advanced <\dia{031F}> \textbar{} retracted <\dia{0320}> 
	  \item[→] raised <\dia{031D}> \textbar{} lowered <\dia{031E}>
	  \item[→] advanced tongue root <\dia{0318}> \textbar{} retracted tongue root <\dia{0319}>
	  \item[→] more rounded <\dia{0339}> \textbar{} less rounded <\dia{031C}>
	  \item[→] creaky voiced <\dia{0330}> \textbar{} breathy voiced <\dia{0324}> \textbar{} voiced <\dia{032C}> \textbar{} voiceless <\dia{0325}>
	  \item[→] syllabic <\dia{0329}> \textbar{} non-syllabic <\dia{032F}>
	\end{itemize}
 \end{itemize}

\noindent Next, if a character sequence contains more than one diacritic above the base
character, we propose the following order:

\begin{itemize}
	\item[] \textsc{Combining Diacritical Marks (above) ordering:}
	\begin{itemize}
	  \item[→] nasalized <\dia{0303}>
	  \item[→] centralized <\dia{0308}> \textbar{} mid-centralized <\dia{033D}>
	  \item[→] extra short <\dia{0306}>
	  \item[→] no audible release <\dia{031A}\ >
 \end{itemize} \end{itemize}

\noindent Then, when a character sequence contains more than one character of the Spacing
Modifier Letters, these will be placed after all combining diacritic marks in the
following order:

\begin{itemize}
	\item[] \textsc{Spacing Modifier Letters ordering:}
	\begin{itemize}
	  \item[→] rhotic hook <\dia{02DE}>
	  \item[→] lateral release <\dia{02E1}> \textbar{} nasal release <\dia{207F}>
	  \item[→] labialized <\dia{02B7}>
	  \item[→] palatalized <\dia{02B2}>
	  \item[→] velarized <\dia{02E0}>
	  \item[→] pharyngealized <\dia{02E4}>
	  \item[→] aspirated <\dia{02B0}> \textbar{} ejective <\dia{02BC}>
	  \item[→] long <\dia{02D0}> \textbar{} half-long <\dia{02D1}>
	\end{itemize}
\end{itemize}

\noindent Finally, Tone markers are put at the end of any such sequence, and the 
tie bar follows at the very end:

\begin{itemize}
  \item[] \textsc{Tone Marks:}
  \begin{itemize}
    \item[→] tone letters <˥ ˦ ˧ ˨ ˩> \textbar{} tone movement <↑ ↓ ↗ ↘>
    \item[→] tie bar <\dia{0361}{\large\fontspec{CharisSIL}◌}>
  \end{itemize}
\end{itemize}

% ==========================
\section{Additions to the IPA}
\label{ipa-additions}
% ==========================

In the course of collecting a large sample of phoneme systems across the world's
languages \citep{Moran2012}, we found that in order to preserve distinctions
both within and across language descriptions, additions to the approved IPA
glyph set were needed. Wherever possible these additions were drawn from the
extIPA symbols for disordered
speech.\footnote{\textbf{Add better reference here: }\url{https://www.internationalphoneticassociation.org/sites/default/files/extIPAChart2008.pdf}}
This section describes our proposed additions to the IPA glyph set. These
additions are not part of the official IPA recommendations, so they should be 
used with care.

\begin{itemize}
  
\item \textsc{Retroflex click} \newline
      Retroflex clicks can be represented by <‼> \textsc{double exclamation
      mark} at \uni{203C}. Note that the (post-)alveolar click <ǃ> at \uni{01C3}
      is confusingly referred to as \textsc{latin letter retroflex click} in the
      Unicode standard, which is probably best seen as an error.
\item \textsc{Voiced retroflex implosive} \newline 
      Although the IPA includes a
      series of voiced implosives (marked with a hook on top, see
      Section~\ref{pitfall-missing-decomposition}), there is no voiced retroflex
      implosive. Following the spirit of the IPA, we propose to use <\charis{ᶑ}>
      \textsc{latin small letter d with hook and tail} at \uni{1D91} for this
      sound.
\item \textsc{Fortis/lenis} \newline
      Languages described as having a fortis/plain/lenis distinction that
      corresponds poorly with the traditional
      voiced/voiceless-unaspirated/voiceless-aspirated continuum can be marked
      using the voiceless glyph for the plain phoneme, and then 
      <\dia{0348}> \textsc{combining double vertical line below} at
      \uni{0348} to mark the fortis articulation, and/or <\dia{0349}>
      \textsc{combining left angle below} at \uni{0349} for the lenis
      articulation.
\item \textsc{Frictionalization} \newline 
      The diacritic <\dia{0353}>
      \textsc{combining x below} at \uni{0353} can be used to represent three
      types of frictionalized sounds: First, click consonants where the release
      of the anterior closure involves an ingressive ``sucking'' sound similar
      to a fricative, for example <kǃ͓ʰ>; second, ``frictionalized'' vowels
      (sounds that are phonologically vocalic, but with sufficiently close
      closures to create buzzing); and third, fricative sounds at places of
      articulation that do not have dedicated fricative glyphs, for example
      sounds with voiceless velar lateral frication, like <ʟ̥͓>.
\item \textsc{Derhoticization} \newline 
      For derhoticization we propose to use
      <\dia{032E}> \textsc{combining breve below} at \uni{032E}. 
      \textbf{WHAT EXACTLY IS THIS?}
\item \textsc{Coronal non-sibilant} \newline
      Languages described as having a sibilant/non-sibilant distinction among
      coronal fricatives and affricates can be handled using the subscript
      <\dia{0347}> \textsc{combining equals sign below} at \uni{0347} to mark
      the non-sibilant phoneme.
\item \textsc{Glottalization} \newline 
      Glottalized sounds can be indicated using
      <\dia{02C0}> \textsc{modifier letter glottal stop} at \uni{02C0}, unless
      it is clear that either ``ejective'' or ``creaky voicing'' are the
      intended sounds (in which cases the standard IPA diacritics should be
      used). Pre-glottalized sounds can be marked with
      <\diareverse{02C0}> to the left of the base
      glyph, for example <\charis{ˀt}>.
\item \textsc{Voiced pre-aspiration} \newline Voiced sounds having
      pre-aspiration can be marked with
      <\diareverse{02B1}> \textsc{modifier letter
      small h with hook} at \uni{02B1} to the left of the base glyph, for
      example <\charis{ʱd}>.
\item \textsc{Epilaryngeal phonation} \newline 
      There are some rare articulations that make
      use of an epilaryngeal phonation mechanism (e.g.,~the “sphincteric vowels”
      of~!Xóõ). To represent these vowels, we propose to use the modifier <\dia{1D31}>
      \textsc{modifier letter capital e} at \uni{1D31} to denote such sphincteric
      phonation.

\end{itemize}

% ==========================
\section{Recommendations}
\label{ipa-recommendations}
% ==========================

Summarizing the pitfalls as discussed in this chapter, we propose to define a 
``strict'' IPA encoding to be used when interoperability of phonetic resources 
is intended. For regular research papers, when only the visual outline is 
important, the details encoding of IPA in electronic format is rather 
unimportant, as long as it looks as expected. So for those regular usage these 
proposals are irrelevant.

TO DO: 
[different kind of profiles]

At the end of this chapter we have added a few longish tables summarizing all
159 different unicode codepoints that form the basis of strict-IPA encoding
(107 letters, 41 diacritics and 11 remaining symbols). Each of
these tables shows a typical glyph, and then lists the Unicode Codepoint,
Unicode Name and IPA description for each symbol.

TO DO:
[ordering]
[additions]


\begin{itemize}[itemsep=6pt]

   \item \textsc{IPA letters} \newline
        The 107 different IPA letters as allowed in strict-IPA encoding are
        listed in Table~\ref{tab:ipa_letters} starting on
        page~\pageref{tab:ipa_letters}.
  \item \textsc{IPA diacritics} \newline The 41 different IPA diacritics and
        tone markers (both Unicode Modifier Letters and Combining Diacritical
        Marks) as allowed in strict-IPA encoding are listed in
        Table~\ref{tab:ipa_diacritics} starting on
        page~\pageref{tab:ipa_diacritics}.
  \item \textsc{IPA remainders} \newline The 11 remaining IPA symbols
        (boundary, stress and intonation markers) as allowed in strict-IPA
        encoding are listed in Table~\ref{tab:ipa_boundaries} on
        page~\pageref{tab:ipa_boundaries}. 
  \item \textsc{IPA additions} \newline
        The 10 proposed additions to the IPA are listed in
        Table~\ref{tab:ipa_additions} on page~\pageref{tab:ipa_additions}.
  
\end{itemize}


\newpage
\input{tables/unicode_letters}
\input{tables/unicode_diacritics} 
\input{tables/unicode_boundaries}
\input{tables/unicode_additions}
